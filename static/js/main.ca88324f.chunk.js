(this.webpackJsonpdrop=this.webpackJsonpdrop||[]).push([[0],{27:function(e,t,n){},29:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=29},41:function(e,t,n){"use strict";n.r(t);var r,c=n(0),a=n.n(c),o=n(8),i=n.n(o),s=(n(27),n(18)),u=n(12),l=n.n(u),f=n(19),d=n(9),j=n(3),b=n(20),p=n.n(b),O=n(7),m=n(22),h=n(6);!function(e){e.ADD_FILE="ADD_FILE",e.SET_FILE_NAME="SET_FILE_NAME"}(r||(r={}));var x=Object(m.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{files:[],fileName:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.ADD_FILE:return Object(O.a)(Object(O.a)({},e),{},{files:[].concat(Object(d.a)(e.files),[t.payload])});case r.SET_FILE_NAME:return Object(O.a)(Object(O.a)({},e),{},{fileName:t.payload});default:return e}})),v=function(){return Object(h.b)()},g=h.c,y=n(1),E=function(){var e=Object(c.useState)(!1),t=Object(j.a)(e,2),n=t[0],a=t[1],o=v();return Object(y.jsx)(y.Fragment,{children:Object(y.jsx)("div",{className:"h-96 rounded-md ".concat(n?"bg-gray-200":"bg-gray-100"," flex items-center justify-center p-4"),onDragEnter:function(e){e.preventDefault(),e.stopPropagation(),a(!0)},onDragLeave:function(e){e.preventDefault(),e.stopPropagation(),a(!1)},onDragOver:function(e){e.preventDefault(),e.stopPropagation()},onDrop:function(e){e.preventDefault(),e.stopPropagation(),a(!1),Array.from(e.dataTransfer.files).forEach((function(e){return o({type:r.ADD_FILE,payload:e})}))},children:Object(y.jsx)("p",{children:"Drag a file here to send it"})})})},w=n(43),D=function(e){var t=e.fileName,n=e.askForSend,c=e.parent,a=e.index,o=v();return Object(y.jsxs)("div",{className:"mb-2 bg-gray-100 rounded-md flex flex-row p-4 justify-between items-center",children:[Object(y.jsx)("div",{children:t}),n&&c&&Object(y.jsx)("button",{className:"text-white stroke-current bg-gradient-to-br p-2 rounded from-green-400 to-blue-500",onClick:function(){o({type:r.SET_FILE_NAME,payload:t}),c.send({type:"requestFile",index:a})},children:Object(y.jsx)(w.a,{})})]})},N=function(){return Object(y.jsx)("header",{className:"mb-2",children:Object(y.jsx)("h1",{children:"Drop"})})},S=n(21),F=n.n(S),_=function(e){var t=e.peerId;return Object(y.jsxs)("div",{className:"flex flex-row gap-8 mb-8 p-4 items-center",children:[Object(y.jsx)(F.a,{className:"",size:128,value:"".concat(window.location.href,"?peer=").concat(t)}),Object(y.jsxs)("div",{children:["Scan this qrcode to receive the file ",Object(y.jsx)("br",{})," or use"," ",Object(y.jsx)("a",{href:"".concat(window.location.href,"?peer=").concat(t),className:"text-blue-800 underline",children:"this link"})]})]})};function L(e,t){var n=document.createElement("a");n.download=e,n.href=URL.createObjectURL(new Blob([t])),n.click()}var I=function(){var e,t=Object(c.useState)(null),n=Object(j.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(null),i=Object(j.a)(o,2),u=i[0],b=i[1],O=Object(c.useState)([]),m=Object(j.a)(O,2),h=m[0],v=m[1],w=Object(c.useState)([]),S=Object(j.a)(w,2),F=S[0],I=S[1],k=g((function(e){return e.files}));return Object(c.useEffect)((function(){var e=new p.a,t=new URLSearchParams(window.location.href.split("?")[1]).get("peer"),n=!!t;e.on("open",(function(r){if(a(r),n){var c=e.connect(t);b(c),c.on("data",(function(e){console.log(e),e instanceof ArrayBuffer?L(x.getState().fileName,e):("files"===e.type&&I(e.files),"file"===e.type&&L(e.name,e.file))}))}else e.on("connection",(function(e){setTimeout((function(){return v((function(t){return[].concat(Object(d.a)(t),[e])}))}),10),e.on("data",function(){var t=Object(f.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"requestFile"===n.type&&(r=x.getState().files[n.index],e.send(r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}))}),[]),Object(c.useEffect)((function(){var e,t=k.map((function(e){return{name:e.name,size:e.size}})),n=Object(s.a)(h);try{for(n.s();!(e=n.n()).done;){e.value.send({type:"files",files:t})}}catch(r){n.e(r)}finally{n.f()}}),[k,h]),e=F.length>0?F:k.map((function(e){return{name:e.name,size:e.size}})),Object(y.jsxs)("div",{className:"max-w-screen-md mx-auto p-4",children:[Object(y.jsx)(N,{}),r&&k.length>0&&Object(y.jsx)(_,{peerId:r}),e.map((function(e,t){return Object(y.jsx)(D,{parent:u,fileName:e.name,index:t,askForSend:null!==u},t)})),Object(y.jsx)(E,{})]})};i.a.render(Object(y.jsx)(a.a.StrictMode,{children:Object(y.jsx)(h.a,{store:x,children:Object(y.jsx)(I,{})})}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.ca88324f.chunk.js.map